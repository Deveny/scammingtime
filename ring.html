<html>
  <head>
    <meta charset="utf-8">
    <meta name="generator" content="GitLab Pages">
    <title>Zoom Outer</title>
      
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
          <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.3.4/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.3.4/CSSRulePlugin.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.3.4/ScrollTrigger.min.js"></script>
  <link rel="stylesheet" href="firstep/first.css">
      <style>
          
@font-face {
  font-family: "round";
  src: url("/assets/fonts/ArialRoundedBold.ttf");
}
#css,
#webgl, #episode {
  width: 100%;
  height: 100%;
  position: absolute;
  top: 0;
  left: 0;
    text-align: center;
}
#css {
      overflow: hidden;
  z-index: 10;
}
#webgl {
      overflow: hidden;
  z-index: 5;
}
          #episode{
              overflow-x: hidden;
              overflow-y: hidden;
              display: none;
              z-index: 1;
          }
body {
  margin: 0;
  background-color: #f5d2b5;
}
.element {
  width: 20vw;
  height: 20vh;
  box-shadow: 0px 0px 12px lightgray;
  background-color: lightgray;
  opacity: 0.6;
  border: 1px solid lightgray;
  border-radius: 5px;
  text-align: center;
  line-height: normal;
  cursor: default;
  transition: animation 2s;
    box-shadow: inset 0 0 1em white;
    -webkit-box-shadow: inset 0 0 1em white;
}
.element:hover {
              
  background: url('assets/surering.png') left top no-repeat, url('assets/greek.jpg') right bottom no-repeat, url('assets/grasstop.png') left top repeat;
  padding: 15px;
  background-size: 50px, 130px, auto;
  transition: animation 2s;
  cursor: pointer;
    
    -webkit-appearance: none;
    box-shadow: inset 0 0 1em white, 0 0 1em white, 0 0 1em lightsalmon,
      0 0 2em lightsalmon, 0 0 3em lightsalmon;
    -webkit-box-shadow: inset 0 0 1em white, 0 0 1em white, 0 0 1em lightsalmon,
      0 0 2em lightsalmon, 0 0 3em lightsalmon;
}
          .allglow{
                background-image: url("assets/greek.jpg");
              
  background-repeat: no-repeat;
  background-size: cover; 
  -webkit-animation: glow 1s ease-in-out infinite alternate;
  -moz-animation: glow 1s ease-in-out infinite alternate;
  animation: glow 1s ease-in-out infinite alternate;
          }
          .allglow:hover{
              opacity: 1;
          }
          .deeper{
  opacity: 1;
              
    font-family: 'Round';

                                font-size: 3vw;
                                font-weight: bold;
                color: rgba(255,255,255,1);
                letter-spacing: 0.7px;
                text-shadow: 0 0 8px pink; 
                font-kerning: normal;

          }
@-webkit-keyframes glow {
  from {
      
    -webkit-appearance: none;
    box-shadow: inset 0 0 1em white, 0 0 1em white, 0 0 1em lightsalmon,
      0 0 2em lightsalmon, 0 0 3em lightsalmon;
    -webkit-box-shadow: inset 0 0 1em white, 0 0 1em white, 0 0 1em lightsalmon,
      0 0 2em lightsalmon, 0 0 3em lightsalmon;
  }
  to {
    -webkit-appearance: none;
    box-shadow: inset 0 0 2em white, 0 0 3em lavender, 0 0 4em lavender,
      0 0 5em lavender, 0 0 6em lavender;

    -webkit-box-shadow: inset 0 0 1em white, 0 0 1em lavender, 0 0 2em lavender,
      0 0 3em lavender, 0 0 4em lavender;
  }
}



</style>
  </head>
  <body>
    <div id="css"></div>
    <div id="webgl"></div>
      <div id="episode"> <div id='pp'></div>

        <div id="p-one"><img src="/assets/firstepisode/pinkass.jpg"id="pinkass" width= '17%' onclick="toPoint()"></div>
        <div id="again"><p>(and again)</p></div>
        <div class="layed">
                <img class="abacate" id='a1'src="/assets/firstepisode/abacate1.jpg" width='17%'><br>
                <img class="abacate" id='a2'src="/assets/firstepisode/abacate2.jpg" width='17%'><br>
                <img class="abacate" id='a3'src="/assets/firstepisode/abacate3.jpg" width='17%'></div>

                <div id="p-txt"></div>
        <div id="video">     

                     <div id='wipe'></div>

<video id='grass' width="100%" height="auto">
            <source src="/assets/firstepisode/grass.mp4" type="video/mp4"></video>
                                <img id="sheets" src="/assets/firstepisode/sheets.jpg" width="20%">
<audio id="sound">
  <source src="/assets/firstepisode/what.mp3" type="audio/mpeg">
</audio>
</div></div>
    <footer>


<script type="module">
import * as THREE from "/three/build/three.module.js";

import { TWEEN } from "/three/examples/jsm/libs/tween.module.min.js";
import { OrbitControls } from "/three/examples/jsm/controls/OrbitControls.js";
import {
  CSS3DRenderer,
  CSS3DObject
} from "/three/examples/jsm/renderers/CSS3DRenderer.js";

var control, controls, camera, scene, webGLrenderer, css3Drenderer, light, domElement, group, HelixSpeed;

init();
animate();

function init() {
  // Create the scene
  scene = new THREE.Scene();
  scene.fog = new THREE.FogExp2(0xffc494, 0.003);

  // Create the camera

  camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight,1,100000);
  camera.position.z = 200;
    
  var light = new THREE.DirectionalLight(0xfff3d4);
  light.position.set(1, 1, 1);
  scene.add(light);

  var light = new THREE.DirectionalLight(0x002288);
  light.position.set(-1, -1, -1);
  scene.add(light);

  var light = new THREE.AmbientLight(0x222222);
  scene.add(light);

    group = new THREE.Group();
    HelixSpeed = 0.001;
  //helix
    for (var i = 0; i < 7; i += 1) {
    var hvector = new THREE.Vector3(); 
    var element = document.createElement("div");
    element.className = "element";
    var object = new CSS3DObject(element);

    var theta = i * 0.90 + Math.PI;
    var y = -450;
    object.position.setFromCylindricalCoords(40, theta, 0);
    object.scale.set(0.1, 0.1, 0.1);
    hvector.x = object.position.x * 2;
    hvector.y = object.position.y;
    hvector.z = object.position.z * 2;

        
    object.lookAt(hvector);
        
        group.add( object );
    element.parent = object;
    object.element.onclick = function () {
    var nvector = new THREE.Vector3();
nvector.copy(this.parent.position);       nvector.negate();
        //nvector.set(this.parent.position.x*2,0,this.parent.position.z*2);    
        tweenCamera(nvector, 5000);
       // this.classList.add("deeper");
        $(this).addClass("deeper").addClass('allglow');
        $(this).siblings('.element').removeClass('deeper').addClass('allglow');
        
        this.onclick = function (){
            newPage();
        }
  };
        
  }
    
    
    	var map = new THREE.TextureLoader().load( '/assets/surering.png' );
				map.wrapS = map.wrapT = THREE.RepeatWrapping;
                map.repeat.set( 3, 1 );

				var material = new THREE.MeshPhongMaterial( { map: map, side: THREE.DoubleSide, transparent: true} );


                object = new THREE.Mesh( new THREE.TorusBufferGeometry( 35, 10, 20, 20 ), material );
				object.position.set( 0, 0, 0 );
                object.rotation.x = 300;
                object.name="surething";

				group.add(object);
    
        scene.add(group);


  //Create the renderers
  var webGLrendererContainer = document.querySelector("#webgl");
  webGLrenderer = new THREE.WebGLRenderer({antialias: true,alpha: true});
  //renderer.setPixelRatio( window.devicePixelRatio );
  webGLrendererContainer.prepend(webGLrenderer.domElement);
  webGLrenderer.setSize(window.innerWidth, window.innerHeight);
  
  var css3DrendererContainer = document.querySelector("#css");
  css3Drenderer = new CSS3DRenderer();
  css3DrendererContainer.prepend(css3Drenderer.domElement);
  css3Drenderer.setSize(window.innerWidth, window.innerHeight);

  // Create the controls
  controls = new OrbitControls(camera, css3Drenderer.domElement);
	controls.screenSpacePanning = false; 
 //controls.minPolarAngle = Math.PI / 2.5;
 // controls.maxPolarAngle = Math.PI / 2;
//controls.minAzimuthAngle = 1.25* Math.PI;
//controls.maxAzimuthAngle = 1.25*Math.PI+0.001;
      controls.addEventListener("change", render);
  window.addEventListener("resize", onWindowResize, false);
  onWindowResize();

  createGeometryFromMap();

  var blueSpot = new THREE.PointLight();
  blueSpot.color = new THREE.Color(0x0000ff);
  blueSpot.intensity =1;
  blueSpot.distance = 1000;

  blueSpot.position.set(300, 70, 0);
  blueSpot.name = 'blue1';
  scene.add(blueSpot);
    
    
  addPointLight(0xff0000, new THREE.Vector3(-400, 0, 0), "red1");
  addPointLight(0xff0000, new THREE.Vector3(-100, 0, 0), "red2");
 // addPointLight(0x0000ff, new THREE.Vector3(300, 70, 0), "blue1");
  control = new (function () {
    this.count = 0.01;
  })();
    
    
}

function addPointLight(color, position, name) {
  var pointLight = new THREE.PointLight();
  pointLight.color = new THREE.Color(color);
  pointLight.intensity =7;
  pointLight.distance = 500;
pointLight.castShadow = true;

  pointLight.position.copy(position);
  pointLight.name = name;
  scene.add(pointLight);

  var bulbMat = new THREE.MeshBasicMaterial();
  bulbMat.color = new THREE.Color(color);
  pointLight.add(new THREE.Mesh(new THREE.SphereGeometry(0.001), bulbMat));
}
function createGeometryFromMap() {
  var depth = 512;
  var width = 512;

        var spacingX = 2;
        var spacingZ = 2;
        var heightOffset =-8;
        var canvas = document.createElement('canvas');
        canvas.width = 512;
        canvas.height = 512;
        var ctx = canvas.getContext('2d');

  var img = new Image();
  img.src = "../assets/waterTINY.jpg";
  img.onload = function () {
    // draw on canvas
    ctx.drawImage(img, 0, 0);
    var pixel = ctx.getImageData(0, 0, width, depth);

    var geom = new THREE.Geometry();
    var output = [];
    for (var x = 0; x < depth; x++) {
      for (var z = 0; z < width; z++) {
        var yValue = pixel.data[z * 4 + depth * x * 4] / heightOffset;
        var vertex = new THREE.Vector3(x * spacingX, yValue, z * spacingZ);
        geom.vertices.push(vertex);
      }
    }

    // we create a rectangle between four vertices, and we do
    // that as two triangles.
    for (var z = 0; z < depth - 1; z++) {
      for (var x = 0; x < width - 1; x++) {
        // we need to point to the position in the array
        // a - - b
        // |  x  |
        // c - - d
        var a = x + z * width;
        var b = x + 1 + z * width;
        var c = x + (z + 1) * width;
        var d = x + 1 + (z + 1) * width;

        var face1 = new THREE.Face3(a, b, d);
        var face2 = new THREE.Face3(d, c, a);

        geom.faces.push(face1);
        geom.faces.push(face2);
      }
    }

    geom.computeVertexNormals(true);
    geom.computeFaceNormals();
    geom.computeBoundingBox();

    var zMax = geom.boundingBox.max.z;
    var xMax = geom.boundingBox.max.x;

    var mesh = new THREE.Mesh(
      geom,
      new THREE.MeshPhongMaterial({
        color: 0x2ad9c6,
        shininess: 40,
        specular: 0x161616
      })
    );
    mesh.translateX(-xMax / 2);
    mesh.translateZ(-zMax / 2);
    mesh.position.y = 0;
    scene.add(mesh);
  };
}
function tweenCamera(targetPosition, duration) {
  controls.enabled = false;
    
  var position = new THREE.Vector3().copy(camera.position);
  var tween = new TWEEN.Tween(position)
    .to(targetPosition, duration)
    .easing(TWEEN.Easing.Exponential.Out)
    .onUpdate(function () {
      camera.position.copy(position);
      camera.lookAt(controls.target);
    })
    .onComplete(function () {
      camera.position.copy(targetPosition);
      camera.lookAt(controls.target);
      //controls.enabled = true;
    })
    .start();
    
    $('.deeper').click(function(){
        newPage;
    });
}
    function newPage(){
        $('#css, #webgl').fadeOut(2000);
        $('#episode').fadeIn(1000);

    }
function onWindowResize() {
  camera.aspect = window.innerWidth / window.innerHeight;
  camera.updateProjectionMatrix();
  css3Drenderer.setSize(window.innerWidth, window.innerHeight);
  webGLrenderer.setSize(window.innerWidth, window.innerHeight);
}
function animate() {
    setTimeout( function() {

        requestAnimationFrame( animate );

    }, 1000 / 30 );  //controls.update();
  TWEEN.update();
  render();
}
function render() {
  webGLrenderer.render(scene, camera);
    
  css3Drenderer.render(scene, camera);

        group.rotation.y += 0.001;

    
  var time = Date.now() * 0.00025;
  var d = 2000;

  var light = scene.getObjectByName("red1");
  light.position.x = Math.cos(time * 0.3) * d;
  light.position.z = 2 * Math.sin(time * 0.7) * d;
  light.position.y = 2 * Math.sin((control.count += 0.005) + 0.5 * Math.PI);

  var light = scene.getObjectByName("red2");
  light.position.x = Math.sin(time * 0.5) * d;
  light.position.z = Math.cos(time * 0.2) * d;
  light.position.y = 5 * Math.sin((control.count += 0.005) + 0.5 * Math.PI);

  var light = scene.getObjectByName("blue1");
      light.position.z = Math.cos(time * 0.2) * d;
  light.position.y = 50 * Math.sin((control.count += 0.005) + 1.5 * Math.PI); 
    var cyli = scene.getObjectByName("surething");
    

    
}
</script> 
<script src="firstep/first.js"></script></footer>
  </body>
</html>